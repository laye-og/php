Text=function(a,b,c,d,e,f,g,h,i){var j=this;j.width,j.height,j.oldwidth,j.oldheight,j.color=d.clone(),j.format=new Textformat(a),j.format.font=b,j.drawningboard=e,j.group=j.drawningboard.workspace.g(),j.path=j.group.path(),j.svg=j.group.text(0,0,""),j.upperlayer=j.group.rect(0,0,0,0),j.path.attr("fill","none"),j.group.attr("pointer-events","fill"),j.x=f,j.y=g,j.realposition=!1,j.offset={x:0,y:0},j.scale=c?c:1,j.scalex=j.scale,j.scaley=j.scale,j.flipx=0,j.flipy=0,j.rotation=0,j.alpha=1,j.id=h,j.subid=i,j.groupid=0,j.statelist=[],j.curvedline={},j.curvedline.enabled=!1,j.curvedline.type="up",j.curvedline.start=!1,j.curvedline.x,j.curvedline.y,j.curvedline.left={},j.curvedline.left.x=0,j.curvedline.left.y=0,j.curvedline.anchorleft={},j.curvedline.anchorleft.x=0,j.curvedline.anchorleft.y=0,j.curvedline.anchorright={},j.curvedline.anchorright.x=0,j.curvedline.anchorright.y=0,j.curvedline.right={},j.curvedline.right.x=0,j.curvedline.right.y=0,j.curvedline.startwidth,j.curvedline.startheight,j.type="text",j.index,j.name,j.iconname,j.companytext=!1,j.start=function(){j.group.addClass("svg-text"),j.realposition||(j.x=j.x?j.drawningboard.width/2+(j.x-j.offset.x/2)*j.scalex:j.drawningboard.width/2,j.y=j.y?j.drawningboard.height/2+(j.y-j.offset.y/2)*j.scaley:j.drawningboard.height/2),j.group.attr({cursor:"move"}),j.update(),j.curvedline.enabled||(j.curvedline.left.x=-50,j.curvedline.left.y=j.height-20,j.curvedline.anchorleft.x=j.width/2-20,j.curvedline.anchorleft.y=j.height-21,j.curvedline.anchorright.x=j.width/2+20,j.curvedline.anchorright.y=j.height-21,j.curvedline.right.x=j.width+50,j.curvedline.right.y=j.height-20,j.curvedline.startwidth=j.width,j.curvedline.startheight=j.height),j.index=j.drawningboard.selector.getnewindex(j.id,j.type),j.subid?(j.name=j.drawningboard.api.dictionary.element_text+" "+j.id+"."+j.subid,j.iconname=j.drawningboard.api.dictionary.element_logo+" "+j.id):j.name=j.drawningboard.api.dictionary.element_text+" "+j.id,j.drawningboard.selector.watch(j)},j.enabled=function(){return j.alpha},j.finish=function(){j.group.remove()},j.translateoffset=function(){var a={x:0,y:0};return a.y=j.height/2*j.scaley-j.height*j.flipy*j.scaley,a.x=j.curvedline.enabled?j.width/2*j.scalex-j.width*j.flipx*j.scalex:"center"==j.format.alignment?0:"left"==j.format.alignment?0:0,a},j.update=function(){j.subid?(j.name=j.drawningboard.api.dictionary.element_text+" "+j.id+"."+j.subid,j.iconname=j.drawningboard.api.dictionary.element_logo+" "+j.id):j.name=j.drawningboard.api.dictionary.element_text+" "+j.id,j.path.attr({d:"M"+j.curvedline.left.x+","+j.curvedline.left.y+" C"+j.curvedline.anchorleft.x+","+j.curvedline.anchorleft.y+" "+j.curvedline.anchorright.x+","+j.curvedline.anchorright.y+" "+j.curvedline.right.x+","+j.curvedline.right.y}),j.svg.attr({"font-size":j.format.size,"font-style":j.format.italic||"Molle"==j.format.font?"italic":"","font-weight":j.format.bold?"bold":"","font-family":j.format.font,textpath:void 0,fill:j.color.getsvgcolor(j.drawningboard.workspace),"text-anchor":"middle"}),j.svg.node.textContent=j.format.text,j.curvedline.enabled&&(j.svg.attr({dy:"",textpath:j.path,x:"",y:""}),"up"!=j.curvedline.type&&j.svg.attr({dy:.6*j.curvedline.startheight}),$(j.svg.node.childNodes[0]).attr("startOffset","50%"));var a=j.svg.getBBox();j.curvedline.enabled?j.upperlayer.attr({width:a.width,height:a.height,x:a.cx-a.width/2,y:a.cy-a.height/2,fill:"none"}):(j.oldWidth=j.width,j.oldHeight=j.height,j.width=a.width+60,j.height=a.height+60,j.upperlayer.attr({width:0,height:0}),j.svg.attr({dy:.65*j.height}),j.oldWidth!=j.width&&("left"==j.format.alignment?j.x-=(j.oldWidth-j.width)*j.scalex/2:"right"==j.format.alignment&&(j.x+=(j.oldWidth-j.width)*j.scalex/2))),j.group.attr({transform:"translate("+parseInt(j.x-j.translateoffset().x)+","+parseInt(j.y-j.translateoffset().y)+") rotate("+parseInt(calc.fixDegree(j.rotation))+" "+j.translateoffset().x+" "+j.translateoffset().y+") scale("+j.scalex*(j.flipx?-1:1)+","+j.scaley*(j.flipy?-1:1)+")",opacity:j.alpha}),j.alpha?(j.group.addClass("svg-visible"),j.group.removeClass("svg-hidden")):(j.group.removeClass("svg-visible"),j.group.addClass("svg-hidden")),window.navigator.userAgent.indexOf("Edge")>-1}};